---
title: "TD2: Étude de données"
author: "Nicolas Gast, Arnaud Legrand"
date: "25 septembre 2015"
output: html_document
---

Reading the data and computing voter turnout

```{R}
library(dplyr)

votes = read.csv("Data/votes.csv")

votes$attendance = votes$total_votes_2016/floor(votes$population2014 - ((votes$AGE295214 / 100) * votes$population2014))

votes$attendance_2012 = votes$total_votes_2012/floor(votes$population2010 - ((votes$AGE295214 / 100) * votes$population2010))

votes$dem_in = votes$votes_gop_2016 - votes$votes_gop_2012 
votes$rep_in = votes$votes_dem_2016 - votes$votes_dem_2012


```


Extracting Hispanic data - counties where hispanic populations > 50%


```{R}

hisp_clint = votes[ which(votes$Hispanic > 0.5 & votes$Clinton > 0.5) , ]
hisp_trump = votes[ which(votes$Hispanic > 0.5 & votes$Trump > 0.5), ]

hisp_clint_tx = votes[ which(votes$Hispanic > 0.5 & votes$Clinton > 0.5 & votes$state_abbr == "TX") , ]
hisp_trump_tx = votes[ which(votes$Hispanic > 0.5 & votes$Trump > 0.5 & votes$state_abbr == "TX"), ]

hisp_bus = votes[ which(votes$SBO415207 > 23), ]

```

#Clinton win - 38 counties (22 in Texas)
#Trump win - 48 counties (35 in Texas)

Plotting the states where hispanic counties appear

```{R}
nrow(hisp_clint)
nrow(hisp_trump)

counts_c = table(hisp_clint$state_abbr)
barplot(counts_c[counts_c>0],main="Clinton", xlab="States")

counts_t = table(hisp_trump$state_abbr)
barplot(counts_t[counts_t>0],main="Trump",xlab="States")

```

Comparison with 2012, changes does not seem significant

```{R}

plot(hisp_clint[c("Obama", "Clinton")])
plot(hisp_trump[c("Romney", "Trump" )])

cor(votes$Romney, votes$Trump)
cor(votes$Obama, votes$Clinton)

cor(hisp_trump$Romney, hisp_trump$Trump)
cor(hisp_clint$Obama, hisp_clint$Clinton)

```

Hispanic-owned firms, percent, 2007 (SBO415207 data) 

Counties having more business voted for clinton



```{R}
summary(hisp_clint$SBO415207)
summary(hisp_trump$SBO415207)

hist(hisp_clint$SBO415207, breaks = 5)
hist(hisp_trump$SBO415207, breaks = 5)

cor(hisp_bus$Clinton, hisp_bus$SBO415207)
cor(hisp_clint$Clinton, hisp_clint$SBO415207)
plot(hisp_bus[c("SBO415207","Clinton")])

nrow(hisp_bus)


```


```{R}
summary(hisp_clint$attendance)
summary(hisp_trump$attendance)

summary(votes$attendance)

hist(hisp_clint$attendance, breaks = 5)
hist(hisp_trump$attendance, breaks = 5)

```







```{R}

interesting = c("Clinton", "Trump","total_votes_2016","state_abbr", "county_name","SEX255214", "White", "Black", "Hispanic","Poverty", "population2014", "Edu_batchelors")



plot(hisp_clint[c("Clinton", "attendance")])
plot(hisp_clint[c("SBO415207", "attendance")])


cor(hisp_trump$Trump, hisp_trump$Trump_Prediction)
cor(hisp_trump$Clinton, hisp_trump$Clinton_Prediction)

cor(hisp_clint$Trump, hisp_clint$Trump_Prediction)
cor(hisp_clint$Clinton, hisp_clint$Clinton_Prediction)

cor(votes$Trump, votes$Trump_Prediction)
cor(votes$Clinton, votes$Clinton_Prediction)

```


```{R}

plot(votes$Hispanic, votes$attendance)


```

Correalations

```{R}

numeric = votes[sapply(votes, is.numeric)]

cor(votes$Clinton,numeric)


```